{% load static %}
<h1> Latest snapshot: {{ snapshot.timestamp }} </h1>

<h2> Weather </h2>
<pre> {{ snapshot.weather.weather | pprint}} </pre>
<h2> Stations </h2>
<ul id="stations"></ul>

<script>
function createNode(element) {
  return document.createElement(element);
}

function append(parent, el) {
  return parent.appendChild(el);
}
const ulStations = document.getElementById('stations');

fetch("http://localhost:8000/api/v1/stations/", {mode: 'cors'})
.then(response => response.json())
.then(function (data) {
	let stations = Object.values(data)[0].stations;
	console.log(stations);
	return Object.values(stations).map(function (item) {
		console.log(item);
		let coordinates = item.geometry.coordinates;
		let li = createNode('li');
		let heading = createNode('h3');
		let pBikes = createNode('p');
		let pDocks = createNode('p');
		let pCoord = createNode('p');
		heading.innerHTML = `${item.properties.name}`;
		pBikes.innerHTML = `Bikes available: ${item.properties.bikesAvailable}`;
		pDocks.innerHTML = `Total docks: ${item.properties.totalDocks}`;
		pCoord.innerHTML = `Coordinates ${coordinates}`;
		append(li, heading);
		append(li, pBikes);
		append(li, pDocks);
		append(li, pCoord);
		append(ulStations, li);
    })
})
.catch(function(error) {
  console.log(error);
});


</script>

